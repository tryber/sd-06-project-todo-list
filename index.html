<html>

<head>
  <title>Minha Lista de Tarefas</title>
</head>

<body>
  <header>
    <h1>Minha Lista de Tarefas</h1>
    <p id="funcionamento">Clique duas vezes em um item para marcÃ¡-lo como completo</p>
  </header>
  <section>
    <!-- A lista de tarefas -->
    <input type="text" id="texto-tarefa" />
    <button id="criar-tarefa">Criar Tarefa</button>

    <ol id="lista-tarefas"></ol>
  </section>

  <script type="text/javascript">

    let tarefas = [];
    let listaTarefas = document.getElementById('lista-tarefas');
    let selected;


    function rebuildList() {
      for (let i = 0; i < tarefas.length; i += 1) {
        let novaTarefa = document.createElement('li');

        listaTarefas.appendChild(novaTarefa);
        novaTarefa.innerText = tarefas[i];
      }
      if (selected !== undefined) {
        console.log(selected);
        listaTarefas.children[selected].style.backgroundColor = 'rgb(128, 128, 128)';
      }
    }

    function selectTarefa() {
      let listNodes = listaTarefas.children;

      for (let i = 0; i < listNodes.length; i += 1) {
        listNodes[i].addEventListener('click', function () {
          if (selected !== undefined) {
            listNodes[selected].style.removeProperty('background-color');
          }
          selected = i;
          listNodes[i].style.backgroundColor = 'rgb(128, 128, 128)';
        });
      }
    }

    function addTarefa() {
      let inputTarefa = document.getElementById('texto-tarefa');
      let botaoTarefa = document.getElementById('criar-tarefa');

      botaoTarefa.addEventListener('click', function () {
        tarefas.push(inputTarefa.value);
        inputTarefa.value = '';

        listaTarefas.innerHTML = '';
        rebuildList();
        selectTarefa();
      });
    }



    window.onload = function () {
      addTarefa();
    }
  </script>
</body>

</html>
